version: 0.2

phases:
  pre_build:
    commands:
      # update nodejs to version 22
      - n 22

  build:
    commands:
      - node -v
      - npm -v
      - npm ci
      - npm run build
      - cd dist
      - mv package.json src/
      - cd src
      - rm -rf pcdb.types.tf
      - zip -r pcdb-sync-lambda.zip .

  post_build:
    commands:
      - echo "Running post_build commands"

artifacts:
  files:
    - dist/src/pcdb-sync-lambda.zip
